# 확률과 확률분포
## 1. 확률의 개념과 특징
- 통계학 : 데이터에 담겨진 표면적인 정보를 정확히 요약하고 그 내면에 담긴 의미를 추록하고 해석하기 위한 도구적인 성격의 학문
- 모수 : 알고자 하는 미지의 정보 (어느 후보의 지지율, 불량률 등) -> 데이터를 활용해 예측

#### 확률의 기본 개념
- 확률 : 어떤 사건이 발생할 가능성을 0에서 1사이의 숫자로 표현
- 확률 모형 : 시행을 반복할 때마다 나오는 결과가 우연에 의존하여 매번 달라지는 현상 또는 실험(확률 실험)에 대한 수리적 모형
- 표본공간 : 확률 실험에서의 모든 관찰 가능한 결과의 집합(S로 표기)\
예) 동전 (앞, 뒤) 주사위 (1, 2, 3, 4, 5, 6)
- 사건 : 표본공간의 임의의 부분집합 (A, B등으로 표기)

#### 확률의 정의 및 성질
- 고전적 접근 : n개의 실험결과로 구성된 표본공간에서 각 실험결과가 일어날 가능성이 같은 경우 m개의 실험결과로 구성된 사건 A의 확률\
P(A) = m / n
- 상대적 비율에 의한 접근
    - n번의 반복된 실험 중 어떤 사건 A가 발생한 횟수를 m이라고 할 때 사건 A의 상대빈도는 m / n 으로 구해짐
    - 이 실험의 반복횟수 n을 무한히 증가했을 때, 사건 A의 상대빈도가 수렴하는 값을 사건 A의 확률로 정의

- 확률의 공리
    1. 임의의 사건 A에 대하여 P(A) >= 0
    2. P(S) = 1
    3. 표본공간 S에 정의된 서로 상호배반인 사건 A1, A2 ... 에 대하여 P(A1 U A2 ...) 합집합 = P(A1) + P(A2) + ... 가 성립
![Alt text](/reference_statistics/image-1.png)

- 공리적 접근방식 : 표본공간을 정의역으로 하며, 3가지 공리를 만족하는 함수를 확률로 정의
- 여사건의 확률
    - P[A^c] 여집합 : 사건 A를 제외한 나머지 사건의 확률
    - P[A^c] = 1 - P[A]
    ![Alt text](/reference_statistics/image-2.png)
- 곱사건의 확률
    - P[A 교집합 B] : 사건 A와 사건 B가 동시에 발생할 확률
    ![Alt text](/reference_statistics/image-3.png)
- 합사건의 확률
    - P[A U B] 합집합 : 사건 A 또는 사건 B가 발생할 확률
    - P[A U B] 합집합 = P[A] + P[B] - P[A 교집합 B]
- 조건부 확률\
: A와 B가 표본공간 S상에 정의되어 있으며 P(B) > 0라고 가정\
이 때 사건 B가 일어났다는 가정하의 사건 A가 일어날 조건부 확률
    - P(A | B) = P(A 교집합 B) / P(B)

    예) A = 주사위에서 3 이하의 숫자(1, 2, 3)\
    B = 주사위에서 짝수(2, 4, 6)\
    결과가 짝수일 때 이 결과가 2일 확률\
    P(A | B) = (1 / 6) / (1 / 2) = 1 / 3
    ![Alt text](/reference_statistics/image-4.png)
- 독립사건 : 두 사건 A와 B가 다음 중 하나를 만족시키면 서로 독립
(단, P(A) > 0, P(B) > 0)
    1. P(A | B) = P(A)
    2. P(A 교집합 B) = P(A) * P(B)
    3. P(B | A) = P(B)

## 2. 베이즈 정리
#### 표본공간의 분할과 전확률 공식
- 표본공간의 분할 : B1, B2, ..., Bk(k개의 원인)가 다음 조건을 만족하면 표본 공간 S의 분할
    - 서로 다른 i, j에 대해 Bi 교집합 Bj = 공집합(상호배반)
    - B1 U B2 U ... U Bk (합집합) = S
    ![Alt text](/reference_statistics/image-5.png)
- 전확률공식
    - 사건 B1, B2, ..., B는 상호배반이며 B1 U B2 U ... U Bk (합집합) = S 일 때, S에서 정의되는 임의의 사건 A에 대해 다음이 성립
    - P(A) = P(A 교집합 B1) + ... + P(A 교집합 Bk)\
    = P(B1)P(A | B1) + ... + P(Bk)P(A | Bk)
    ![Alt text](/reference_statistics/image-6.png)

#### 베이즈 정리
- 베이즈정리 : 데이터라는 조건이 주어졌을 때의 조건부 확률을 구하는 공식
- 사건 B1, B2, ..., Bk는 상호배반이며, B1 U B2 U ... U Bk (합집합) = S라고 함
- 이 때 사건 A가 일어났다는 조건 하에 사건 Bi가 일어날 확률\
P(Bi | A) = P(A 교집합 Bi) / P(A) = P(Bi)P(A | Bi) / P(B1)P(A | B1) + ... + P(Bk)P(A | Bk)
![Alt text](/reference_statistics/image-7.png)
![Alt text](/reference_statistics/image-8.png)


## 3. 확률변수와 확률분포, 분포의 특성치
#### 확률변수
- 확률변수 : 표본공간에서 정의된 실수값 함수
    - 이산형 확률변수 : 확률변수가 취할수 있는 값이 셀 수 있는 경우(예. 고객 사고건 수, 불량 수)
    - 연속형 확률변수 : 주어진 구간에서 모든 실수 값을 취할 수 있어 셀수 없는 경우(예. 시간, 길이)

#### 확률분포
- 확률질량함수(이산형 확률변수)\
: 확률변수 X가 이산형인 경우 X가 취할 수 있는 값 x1, x2, ..., xn의 각각에 대하여 확률 P[X = x1], P[X = x2], ..., P[X = xn]을 대응시켜주는 관계\
f(x)는 X 내에서 x가 일어날 확률\
f(xi) = P[X = xi], i = 1, 2, ..., n
    1. 모든 i = 1, 2, ..., n에 대해 0 <= f(xi) <= 1
    2. 모든 f(xi)의 합 = 1

- 확률밀도함수(연속형 확률변수)\
: 확률변수 X가 연속형인 경우 X가 가질 수 있는 구간(-무한, 무한)위에서의 함수 f(x)가 다음을 만족할 때
![Alt text](/reference_statistics/image-9.png)
![Alt text](/reference_statistics/image-10.png)

- 누적분포함수\
: -X의 확률밀도함수가 f(x)일 때 X의 누적분포함수 F(x)는 X <= x인 모든 X에 대한 f(x)의 적분값이 됨
![Alt text](/reference_statistics/image-11.png)
    1. F(-무한대) = 0, F(무한대) = 1
    2. x가 증가할 때 F(x)도 증가하며, F(x)는 음의 값을 가질 수 없음

#### 확률분포의 특성치
- 기대값 : 분포의 무게중심, 중심 위치를 나타냄
![Alt text](/reference_statistics/image-12.png)
- 분산 : 분포의 산포
![Alt text](/reference_statistics/image-13.png)
- 표준편차 : 분산의 제곱근(단위가 보정됨)
![Alt text](/reference_statistics/image-14.png)


## 4. 이항분포, 포아송분포, 지수분포, 감마분포
#### 이항분포
- 베르누이시행 : 아래 두 가지 조건을 만족하는 실험
    - 매 시행마다 '성공' 또는 '실패'의 두 가지 결과만 가짐
    - '성공'의 확률이 p로 일정\
예) 동전 실험
- 이항 확률변수가 고려되는 실험 : 베르누이시행을 독립적으로 n번 반복하는 실험
    - X : n번 시행 중 '성공'의 횟수로 정의
    - 이항확률 변수 x = 0, 1, ..., n의 값을 가짐
    - ![Alt text](/reference_statistics/image-15.png)
    - 이 경우 X~Bin[n, p]
![Alt text](/reference_statistics/image-16.png)

- 이항분포의 특성치\
: X~Bin[n, p]일 때,
    - 기대값(평균값) E[X] = np
    - 분산 V[X] = np(1-p)

#### 포아송 분포
- 단위시간(t=1), 포아송확률과정을 따르는 사건 A가 발생하는 횟수 X일 때\
f(x) = P(X = x) = exp(-m) * m^x / x! (x = 0, 1, 2, ...)
- 이 경우 X~POI[m]

- 포아송 분포의 특성치
    - X~POI[m]인 경우 : E[X] = V[X] = m

    
예) 하루 평균 고속도로 교통사고 발생 2건 일 때 하루 3건일 확률\
X~POI[2]이고 P[X = 3] = 위의 식 활용

#### 지수분포
- 단위구간에서 평균발생횟수가 m인 포아송 확률과정을 따르는 사건 A가 한번 일어난 뒤 그 다음 또 일어날 때까지 걸리는 시간 W로 정의
![Alt text](/reference_statistics/image-17.png)
X~EXP[람다]
- 지수분포의 특성치
    - 포아송모수와 지수모수는 역의 관계 : 단위구간 내 평균발생횟수가 m인 포아송과정을 따르는 사건은 사건 사이 소요시간의 평균이 람다 = 1/m

#### 감마분포
- 감마확률변수 X의 확률밀도함수는 양수인 세타와 k에 대해
![Alt text](/reference_statistics/image-18.png)
이 경우 X~GAMMA[k, 세타]
    - 감마분포의 특성치\
        - X~GAMMA[k, 세타]인 경우\
        E[X] = k*세타\
        V[X] = k * 세타^2


## 5. 정규분포, 표준정규분포
#### 정규분포
- 확률변수 X가 평균이 u, 분산이 시그마^2 이고, 다음의 확률밀도함수를 가질 때 X는 정규분포를 따름
![Alt text](/reference_statistics/image-19.png)
이 경우 X~N [u, 시그마^2]
![Alt text](/reference_statistics/image-20.png)

    - u는 분포의 중심
    - u를 중심으로 대칭이고 u에서 가장 큰 값이 되는 하나의 봉우리만 가짐
    - 시그마^2이 크면 분포의 산포가 커짐

- 정규분포의 특성치\
X~N[u, 시그마^2]인 경우
    - E[X] = u
    - V[X] = 시그마^2

#### 표준정규분포
- X~N[u, 시그마^2]일 때, 정규분포의 선형불변성에 의해 Z = (X-u) / 시그마 ~N[0, 1]이 되며, 이 때 평균이 0, 분산이 1인 정규분포
![Alt text](/reference_statistics/image-21.png)

- 표준정규 확률변수의 (1 - a)분위수 : Z_a\
Z~N[0, 1]일 때 P[Z < c] = 1 - a 를 만족하는 Z의 (1-a)분위수 c를 Z_a로 표기
![Alt text](/reference_statistics/image-22.png)


## 6. 카이제곱분포, t분포, f분포
#### 카이제곱분포 : 표준정규들의 제곱합이 가지는 분포
- Z1, Z2, ..., Zk가 k개의 서로 독립인 표준정규 확률변수(Zi~N[0, 1], i=1, 2, ..., k)라고 할 때,\
X = Z1^2 + Z2^2 + ... + Zk^2가 따르는 분포를 자유도가 k인 카이제곱분포라고 정의
![Alt text](/reference_statistics/image-23.png)
이 경우 X~x^2[k]

- 카이제곱분포의 특성치:\
X~x^2[k]인 경우
    - E[X] = k
    - V[X] = 2k
    ![Alt text](/reference_statistics/image-24.png)

- 카이제곱 확률변수의 (1-a)의 분위수 : x^2_a, k\
X~x^2[k]일 때, P[X > c] = a를 만족하는 X의 (1-a)분위수 c
![Alt text](/reference_statistics/image-25.png)


#### t분포 : 표준정규에 평균이 가지는 분포
- Z가 표준정규확률변수 Z~N[0, 1]일 때, U가 자유도가 k인 카이제곱확률변수 U~x^2[k]이며, Z와 X는 서로 독립이라고 할 때 X = Z / 루트(U/k) 가 따르는 분포를 자유도가 k인 t분포라고 정의
![Alt text](/reference_statistics/image-26.png)
![Alt text](/reference_statistics/image-27.png)

- t분포의 특성치\
X~t[k]인 경우
    - E[X] = 0
    - V[X] = k / k-2 (단 k > 2)

- t분포 확률밀도함수 개형
X~t[k]인 경우
    - 가운데 0을 중심으로 대칭인 종모양의 분포
    - 표준정규분포보다 꼬리가 두꺼움
    - 자유도 k가 커짐에 따라 산포가 줄어들어 표준정규분포로 수렴

- t확률변수의 (1-a)분위수 : t_a,k
X~t[k]일 때, P[X > c] = a를 만족하는 X의 (1-a)분위수 c
![Alt text](/reference_statistics/image-28.png)

#### f분포 : 2개의 카이제곱분포의 비율이 만들어내는 분포
- U가 자유도가 k1인 카이제곱 확률변수 U~x^2[k1]이며 V가 자유도가 k2인 카이제곱 확률변수 V~x^2[k2]이고 U와 V는 서로 독립이라고 할 때 X = (U/k1) / (V/k2)가 따르는 분포를 자유도가 k1, k2인 F분포
![Alt text](/reference_statistics/image-29.png)
X~F[k1, k2]라고 함

- F분포의 특성치\
X~F[k1, k2]인 경우
![Alt text](/reference_statistics/image-30.png)
![Alt text](/reference_statistics/image-31.png)

- F 확률변수의 (1-a)분위수 : F_a,k1,k2\
X~F[k1, k2]일 때, P[X > c] = a를 만족하는 X의 (1-a)분위수 c
![Alt text](/reference_statistics/image-32.png)

# 탐색적 데이터분석
## 7. 그래프에 의한 기술통계
- 질적 자료(값이 문자나 성질로 표현 예. 성별, 혈액형 등)
    - 1개 변수 : 바차트(막대그림), 파이차트\
    ![Alt text](/reference_statistics/image-33.png)
    - 2개 변수 : 히트맵, 스택드컬럼차트\
        - 스택트컬럼차트
        ![Alt text](/reference_statistics/image-34.png)\
        - 히트맵
        ![Alt text](/reference_statistics/image-35.png)
    
- 양적 자료(값이 숫자로 표현 예. 나이 등)
    - 1개 변수 : 히스토그램, 박스플롯(상자그림), 라인차트, QQ플롯\
        - 히스토그램(가로축 실수) : 막대그래프(가로축 항목)과의 차이점
        ![Alt text](/reference_statistics/image-36.png)
        - 박스플롯(상자그램)
        ![Alt text](/reference_statistics/image-37.png)
        - QQ플롯 : 정규분포에 가까울수록 선형에 가깝다
        ![Alt text](/reference_statistics/image-38.png)
        ![Alt text](/reference_statistics/image-39.png)
        ![Alt text](/reference_statistics/image-40.png)

    - 2개 변수 : 산점도
    ![Alt text](/reference_statistics/image-41.png)


## 8. 위치, 변이, 모양 통계량
#### 중심 위치 척도
- 평균 : 표본 자료 x1, ..., xn이 주어졌을 때,\
x = (x1 + x2 + ... + xn) / n

- 중위수, 중앙값 : 표본 자료 x1, ..., xn을 오름차순 정렬하였을 때,\
x_med \
= (n+1)/2번째 자료 (n이 홀수)\
= n/2번째와 (n/2)+1번째 자료 (n이 짝수)

- 최빈값 : 가장 빈도가 높은 값 또는 구간

![Alt text](/reference_statistics/image-43.png)

#### 상대적 위치 척도
- 사분위수 : Q1, Q2, Q3
    - Q1(=x_(n+1)/4) : 25%, 1사분위수
    - Q2(=x_(n+1)/2) : 50%, 2사분위수
    - Q3(=x_3(n+1)/4) : 75%, 3사분위수

#### 변동성 척도
- 범위 : 표본 자료 x1, ..., xn이 주어졌을 때,\
max(xi) - min(xi)

- 사분위간 범위 : Q3 - Q1

- 표본 분산 : 표본 자료 x1, ..., xn이 주어졌을 때,\
![Alt text](/reference_statistics/image-44.png)

- 표본 표준 편차 : \
S = 표본분산의 제곱근

- 변동계수 : 평균대비 표준편차\
스케일의 차이가 클 때, 자료의 단위가 다를 때 사용\
cv = s / 평균

#### 형태 척도
- 왜도 : 분포의 비대칭 정도를 나타내는 척도
- 첨도 : 분포의 중심에서 뾰족함 정도를 나타내는 척도
![Alt text](/reference_statistics/image-45.png)


## 9. 연관성
#### 선형적 연관성
- 선형적 연관성의 방향
![Alt text](/reference_statistics/image-46.png)

- 선형적 연관성의 강도
![Alt text](/reference_statistics/image-47.png)

- 표본 공분산 : n쌍의 표본자료 (x1, y1), ..., (xn, yn)이 주어졌을 때,\
sxy = {(x1 - x평균)(y1 - y평균) + ... + (xn - x평균)(yn - y평균)} / (n-1)

    - 선형관계의 방향
        - sxy > 0 : 양의 선형 관계, 비례관계
        - sxy < 0 : 음의 선형 관계, 반비례관계

    - 선형관계의 강도
        - -sx sy <= sxy <= sx sy (by Cauchy-Schwarz부등식)
        - 표본공분산은 x와 y의 측정 단위에 의존하는 지표\
        x' = ax + b이고, y' = cy + d인 경우에 sx'y' = ac * sxy

- 표본 상관계수 \
rxy = sxy / (sx * sy)\
-1 <= rxy <= 1(by Cauchy-Schwarz 부등식)
    - 선형관계의 방향
    1. rxy > 0 : 양의 선형관계
    2. rxy < 0 : 음의 선형관계

    - 선형관계의 강도
    1. |rxy| = 0 강도가 약함
    2. |rxy| = 1 강도가 강함

    - 표본상관계수는 x와 y의 측정단위에 의존하지 않음\
    x' = ax + b, y' = cy + d이고, ac > 0인 경우에 r_x'y' = r_xy

![Alt text](/reference_statistics/image-48.png)

- 순위를 이용한 상관계수 : 서열 척도이거나 정규분포를 심하게 벗어나는 두 숫자형 변수의 연관성 파악
    - 스피어만 상관계수
        -  원 자료값의 순위를 구한 뒤 순위에 대하여 피어슨의 상관계수를 구한 것
        - -1 에서 1 사이의 값을 가지며, 절대값이 클수록 강한 상관관계를 나타냄

    - 켄달 상관계수
        - 두 변수 순위의 일치 정도를 측정
        - 한 변수의 순위가 증가할 때 다른 변수의 순위도 함께 증가하는 경우가 그렇지 않은 경우에 비해 얼마나 큰지를 측정하는 방식


# 추정과 검정
## 10. 통계적 추론 개요, 표본추출법
![Alt text](/reference_statistics/image-49.png)

- 모집단의 변수 X의 확률분포함수를 f(x)로 가정
- 모집단 f(x)로부터의 확률표본 X1, X2, ..., Xn은 다음의 두가지 성질을 만족하는 모집단 f(x)로부터의 표본을 뜻함
    - X1, X2, ..., Xn은 서로 독립
    - X1, X2, ..., Xn은 모두 동일하게 f(x)의 분포를 따름

- 통계량 : 확률표본 X1, X2, ..., Xn의 함수\
    예) 표본평균 
- 표본분포 : 통계량의 확률분포

#### 표본추출방법
- 단순임의 추출법
    - 모집단을 구성하는 모든 원소에 대해 표본으로 추출될 확률을 동일하게 해주는 표본추출법
    - 난수표에서 난수를 발생시켜 표본을 추출\
    예) N개의 원소로 구성된 모집단에서 n(<=N)개의 표본을 추출할 때 각 원소에 1, 2, ..., N까지의 번호를 부여하고 여기서 n개의 번호를 임의로 선택하여 그 번호에 해당하는 원소를 표본으로 추출
    ![Alt text](/reference_statistics/image-50.png)

- 계통 추출법
    - N개의 원소로 구성된 모집단에서 n(<= N)개의 표본을 추출할 때 각 원소에 1, 2, ..., N까지의 번호를 부여하고 이를 순서대로 나열함
    - K(= N/n)개씩 n개의 구간으로 나눔
    - 첫번째 구간에서 K개의 원소 중 하나를 임의로 선택하고 그 이후는 K개씩 띄어서 표본을 추출함
    - 사이클을 가지는 구조라면 편향된 자료가 추출될 수 있음
    ![Alt text](/reference_statistics/image-51.png)

- 집락 추출법
    - 모집단이 몇 개의 집락이 결합된 형태로 구성되어 있고 각 집락에서 원소들에게 일련번호를 부여할 수 있는 경우에 이용
    - 일부 집락을 랜덤하게 선택한 뒤 선택된 각 집락에서 표본을 임의로 선택
    ![Alt text](/reference_statistics/image-52.png)

- 층화추출법
    - 상당히 이질적인 원소들로 구성된 모집단에서 각 계층을 고루 대표할 수 있도록 표본을 추출
    - 이질적인 모집단의 원소들을 서로 유사한 것끼리 몇 개의 층으로 나눈 후 각 층에서 표본을 랜덤하게 추출
    ![Alt text](/reference_statistics/image-53.png)


## 11. 점추정과 구간추정
- 추정량 : 모수(세타)의 추정에 사용되는 통계량을 세타의 추정량이라고 함
- 추정치 : 관찰된 표본자료로 추정량의 값을 계산한 것

- 점추정 : 하나의 모수를 한 개의 값으로 추정
- 구간추정 : 모수가 포함되리라 기대되는 구간으로 모수를 추정

- 모수(세타)에 대한 신뢰구간 도출을 위해서는 다음을 알아야 함
    - 추정량
    - 추정량의 표본분포 : 일반적으로 모수(세타)에 의존

- 신뢰구간 \
: 모수(세타)의 추정량을 적절하게 변형한 L과 U이 있어 다음을 만족하는 경우,\
P[L <= 세타 <= U] = 1 - a, (0 <= a <= 1) \
구간 (L, U)을 세타의 100(1- a)% 신뢰구간이라고 함
100(1 - a)% : 신뢰수준

- 모평균 u에 관한 신뢰구간(신뢰수준 : 1-a)
    - 모수
        - 모평균 u
    - 추정량
        - 표본평균 Xbar

    - 추정량의 표본분포
        - X1, ..., Xn이 모분산 시그마^2이 알려진 정규모집단 N[u, 시그마^2]으로부터의 확률표본인 경우
        ![Alt text](/reference_statistics/image-54.png)

![Alt text](/reference_statistics/image-55.png)
![Alt text](/reference_statistics/image-56.png)

- 신뢰수준 : 동일한 구간 추정법을 반복적으로 사용할 때 얻어지는 신뢰구간들이 참값(세타)를 품을 확률
    ![Alt text](/reference_statistics/image-57.png)
    - u에 관한 추정에서 신뢰수준 90%의 의미는 n개의 표본을 추출하는 과정을 반복하여 매번 이 구간 추정식으로 신뢰구간을 계산한다면, 이들 중 90%에 해당하는 신뢰구간들이 참값 u를 포함하는 것을 의미
    - n개의 표본으로 구한 하나의 신뢰구간에 모수가 포함되었는지 여부는 알 수 없음


## 12. 가설검정의 원리
#### 가설검정 
- 가설검정 : 표본으로부터 주어지는 정보를 이용하여 모수에 대한 예상, 주장 또는 추측 등의 옳고 그름을 판정하는 과정

- 가설 : 모수에 대한 예상, 주장 또는 추측을 표현
    - 귀무가설(H0) : 지금까지 사실로 알려져 있는 가설
    - 대립가설(H1) : 표본자료로부터의 강력한 증거에 의해 입증하고자하는 가설
    - 가설검정은 표본의 정보가 귀무가설 H0에 대한 충분한 반증이 되는가를 보는 것
    - 결론도 '귀무가설 H0을 기각' 또는 '귀무가설 H0을 기각하지 못함' 중 하나로 표현

- 가설유형 : 관심 모수가 u이고 검정하고자 하는 모수의 경계값이 u0라고 할 때,\
![Alt text](/reference_statistics/image-58.png)

- 검정통계량
    - 귀무가설 H0과 대립가설 H1 중 어느 하나를 택하는 기준을 결정하는 통계량
    - 모집단이 모분산이 알려진 정규분포인 경우 모평균 u에 관한 검정의 경우,
        - 검정통계량 : 표본평균 X의 함수 ![Alt text](/reference_statistics/image-59.png)
        - 검정통계량 표본분포 ![Alt text](/reference_statistics/image-60.png)
        - 귀무가설이 H0 : u = u0이 사실일 때, ![Alt text](/reference_statistics/image-61.png)
        ![Alt text](/reference_statistics/image-62.png)

#### 귀무가설 H0의 기각여부를 판단하기 위한 2가지 접근방식 : 두 방식은 동일한 결론을 가짐
- 기각역에 의한 검정
    - 기각역 : 귀무가설 H0을 기각하게 하는 검정통계량 관측치의 영역
- 유의확률에 의한 검정
    - 유의확률(p-value) : 귀무가설 H0가 사실인 경우의 검정통계량의 분포에서 대립가설 H1의 방향으로 검정통계량의 관찰값보다 더 극단적인 값이 나올 확률로 검정
    - 모분산(시그마^2)이 알려진 정규 모집단에서 모평균 u에 관한 검정의 경우, 귀무가설 H0가 사실일 때
    ![Alt text](/reference_statistics/image-63.png)
    ![Alt text](/reference_statistics/image-64.png)
    ![Alt text](/reference_statistics/image-65.png)
    - 유의확률의 해석
        - 유의확률은 값이 작을수록 해당하는 표본은 귀무가설 H0가 사실인 경우의 표본으로 보기 어려우며, 대립가설 H1을 더욱 지지하는 것으로 해석할 수 있음
        - 유의확률이 일정수준보다 작으면 귀무가설 H0를 기각
    - 가설검정에서의 의사결정에서 발생할 수 있는 오류
    ![Alt text](/reference_statistics/image-66.png)
        - 제 1종 오류(a 알파) : 실제로는 귀무가설 H0가 사실인데, 귀무가설 H0을 기각하게 되는 오류
        - 제 2종 오류(b 베타) : 실제로는 대립가설 H1이 사실인데, 귀무가설 H0을 기각하지 못하게 되는 오류
    - 유의수준 100 a%의 검정법
        - 2종류의 오류는 서로 상충관계로 동시에 줄이기 어려움
        - 더 위험한 제 1종 오류를 일정수준을 넘지못하도록 제한하면서, 제2종오류를 최소로하도록 하는 검정법을 찾고자 함
        - 유의수준 : 제 1종 오류를 범할 확률의 최대 허용 한계
        - 자료로부터 계산된 유의확률이 주어진 유의수준 a보다 작은 경우에 귀무가설 H0를 기각함\
        유의확률 <= 유의수준(a)면 귀무가설 H0를 기각


## 13. 모평균에 관한 가설검정(one sample t test)
- 모분산을 모르는 경우 t-분포이용(자유도 : n-1)
- u에 관한 추론 : 추정량 X의 표본분포가 필요
![Alt text](/reference_statistics/image-67.png)
- 모집단이 정규분포이고 모분산 시그마^2이 알려진 경우\
![Alt text](/reference_statistics/image-68.png)
- 모집단이 정규분포이고 모분산 시그마^2이 알려지지 않은 경우
![Alt text](/reference_statistics/image-69.png)

- 검정통계량
    - 모집단이 정규분포이고 모분산 시그마^2이 알려지지 않은 경우
        ![Alt text](/reference_statistics/image-70.png)
    - 검정통계량 T는 귀무가설 H0(u=u0)일 때
        ![Alt text](/reference_statistics/image-71.png)

- 유의확률의 계산 및 유의수준 100(1-a)% 검정법
    - 귀무가설 H0가 사실일 때 검정통계량 T의 분포에서 t0(=표본자료로부터 계산된 검정통계량의 값)보다 대립가설 방향으로 더 극단적인 값이 나올 확률
    ![Alt text](/reference_statistics/image-72.png)
    - 자료로부터 계산된 유의확률(p-value)이 주어진 유의수준 a보다 작은 경우에 귀무가설 H0를 기각\
    p-value <= a면 H0를 기각


## 14. 모평균 비교에 관한 가설검정(independent two sample t test)
- 두 모집단의 모평균(u1 - u2)차이
    - 독립인 두 표본
    - 등분산 가정 : 시그마1^2 = 시그마2^2 = 시그마^2
    - 정규모집단
    ![Alt text](/reference_statistics/image-73.png)

- 세타 = u1 - u2에 관한 추론 : 추정량의 표본분포를 이용

#### 추정량의 표본분포
- 추정량의 표본분포 : 두 모집단이 정규분포이고 모분산 시그마^2이 알려지지 않았지만 동일한 것으로 가정, 두 표본은 독립
![Alt text](/reference_statistics/image-74.png)
![Alt text](/reference_statistics/image-75.png)

#### 독립이표본 t-검정
- 두 그룹에서 추출된 표본들이 서로 완전히 무관한 상태라 가정
- 가설유형 : 관심모수가 u1-u2이고 검정하고자 하는 모수의 경계값은 0이 됨
![Alt text](/reference_statistics/image-76.png)
- 검정통계량 T는 귀무가설 H0(u1-u2 = 0)이 사실일 때,\
![Alt text](/reference_statistics/image-77.png)
- 유의확률의 계산
    - 귀무가설 H0가 사실일 때, 검정통계량 T의 분포에서 t0(=표본자료로부터 계산된 검정통계량의 값)보다 대립가설 방향으로 더 극단적인 값이 나올 확률
    - 유의수준 100a %의 검정법 : 자료로부터 계산된 유의확률이 주어진 유의수준 a보다 작은 경우에 귀무가설 H0를 기각\
    p-value <= a면 H0를 기각


## 15. 모평균 비교에 관한 가설검정(paired t test)
- 대응표본
    - 표본추출 : 두 모집단으로부터 추출된 서로 짝을 이루는 표본
    - 예시 : 체중, 나이 등이 유사한 2명씩 짝을 지어 한명은 A약, 다른 한 명은 B약을 투여한 뒤 혈압을 측정
    ![Alt text](/reference_statistics/image-78.png)
- 독립인 두 표본
    - 표본추출 : 두 모집단으로부터 각각 독립적으로 추출된 표본
    - 예시 : A약을 투여한 그룹과 B약을 투여한 그룹에 대하여 혈압을 측정

- 대응표본에 대한 모평균차이(ud)에 관한 추론 : 추정량(d_bar)의 표본분포를 이용

#### 쌍체 t-검정
- 두 그룹에서 관찰한 표본들이 서로 짝지어져 있는 상태
- 독립적으로 추출한 경우 대비 표본정보의 변동성이 줄어들어 검정력 높은 검정 가능

- 가설유형 : 관심모수(ud)가 검정하고자 하는 모수의 경계값은 0
![Alt text](/reference_statistics/image-79.png)
- 검정통계량과 표본분포
    - 대응표본간 차이 d1, ..., dn이 분산이 알려지지 않은 정규분포를 따른다고 가정
    - 검정통계량 T는 귀무가설 H0(ud = 0)이 사실일 때,\
    ![Alt text](/reference_statistics/image-80.png)
- 유의확률의 계산 : 귀무가설(H0)가 사실일 때 검정통계량 T의 분포에서 t0(=표본자료로부터 계산된 검정통계량의 값)보다 대립가설 방향으로 더 극단적인 값이 나올 확률
    - 유의수준 100a %의 검정법 : 자료로부터 계산된 유의확률(p-value)이 주어진 유의수준 a보다 작은 경우에 귀무가설 H0를 기각\
    p-value <= a면 H0를 기각


## 16. 모평균 비교에 관한 가설검정(One way ANOVA 및 사후검정)
- 분산분석(ANOVA) 
: 2개 이상의 모집단의 모평균의 차이를 검정\
평균 차이를 파악하기 위해 변동성을 이용 : 그룹별 평균이 다르면 그룹별 평균의 변동성이 크다는 사실을 이용

- 요인(factor) : 모집단(그룹)의 구분기준
- 처리(treatment) : 요인을 구성하는 각 모집단(그룹)

#### 일원분산분석(One Way ANOVA)
- 1개의 요인에 대해 k개의 처리(그룹)로 분류되어 있는 자료
- 가정
    - 정규, 등분산, 독립
    - k개의 모평균 u1, u2, ..., uk이 모두 동일한지 아닌지를 검정
- 제곱합의 분해 : \
총변동성(SST) = 오차에 의한 변동(SSE) + 요인에 의한 변동(SSTR)\
![Alt text](/reference_statistics/image-81.png)
    - 총제곱합(SST) : 그룹에 무관한 전체 자료의 변동을 측정
    - 오차제곱합(SSE) : 각 그룹 내에서의 변동을 측정
    - 요인제곱합(SSTR) : 각 그룹 별 평균의 변동을 측정\
    (SSTR의 크기로 집단별 모평균 차이를 파악할 수 있음)
- 그룹별 모평균이 모두 동일한 경우의 그룹간 변동은 그룹내 변동에 의존
![Alt text](/reference_statistics/image-82.png)
- 그룹간 모평균 차이를 파악하기 위해서는 그룹 내 변동에 비해 그룹간 변동의 상대적 크기를 측정해야 함

- 검정통계량
    - 평균제곱 : 제곱합들을 각각의 자유도로 나눈 값\
    MSTR = SSTR / (k-1), MSE = SSE / (nk -k)
    - 만일 그룹별 모평균이 같다면 MSTR =(유사) MSE
    - 만일 그룹별 모평균이 모두 같지 않다면 MSTR >> MSE
    - 귀무가설 (H0)이 사실인 경우,\
    X = MSTR / MSE ~F[k-1, nk-k]
- 유의확률의 계산
    - 귀무가설 H0가 사실일 때, 검정통계량 X의 분포에서 x0(=표본 자료로부터 계산된 검정통계량의 값)보다 더 큰 값이 나올 확률
    - 유의수준(100a%)의 검정법 : 자료로부터 계산된 유의확률(p-value)이 주어진 유의수준 a보다 작은 경우에 귀무가설 H0를 기각\
    p-value <= a면 H0를 기각
    - 분산분석표
    ![Alt text](/reference_statistics/image-83.png)

- 사후검정 \
: 분산분석은 모든 집단의 모평균이 동일한지, 하나 이상의 집단에서 모평균의 차이가 나는지에 대해서만 파악함. \
따라서 집단별 차이가 존재하는 것으로 결론이 나더라도 어느 집단에서 차이가 발생하는지는 알 수 없음
    - 사후 검정을 통해 어떤 집단에서 차이가 발생하는지를 확인할 수 있음
        - Fisher의 LSD방식
        - Tukey의 W방식
        - Duncan의 Multiple Range Test
        - Scheffe의 S방법
        - Dunnett의 방식


## 17. 모평균 비교에 관한 가설검정(Two way ANOVA)
- 요인 설계 : 반응변수에 영향을 미치는 요인의 수가 여러 개인 경우 요인설계를 적용해야 함

#### 이원배치 분산분석
- 가장 단순한 요인설계분석법으로 요인이 2개, 각 요인별 처리 수준이 2개이상인 경우
    - 주효과 : 각 요인별 처리수준간의 모평균차이에 관한 분석
    - 상호작용효과 : 두 요인간 상호작용에 관한 분석
- 완전 확률화 과정 : 실험대상은 각 요인의 처리수준별 조합(셀)에 무작위로 배치
- 가정 : 정규, 등분산, 독립

- 이원배치 분산분석 자료구조(각 셀 별 반복수 n이 동일한 경우)
![Alt text](/reference_statistics/image-84.png)

- 제곱합의 분해 :\
SST = SSA + SSB + SSAB + SSE\
총변동성 = 요인 A 처리 변동 + 요인 B 처리 변동 + 요인 A, B의 상호작용변동 + 오차 변동\
(abn-1) = (a-1) + (b-1) + (a-1)(b-1) + ab(n-1)

- 가설
    1. 요인 A의 처리효과에 관한 가설
        - H0 : 요인 A의 처리 그룹간 평균의 차이가 없음. 처리효과 없음
        - H1 : 요인 A의 처리 그룹간 평균의 차이가 존재. 처리효과 있음
    2. 요인 B의 처리효과에 관한 가설
        - H0 : 요인 B의 처리 그룹간 평균의 차이가 없음. 처리효과 없음
        - H1 : 요인 B의 처리 그룹간 평균의 차이가 존재. 처리효과 있음
    3. 요인 A와 요인 B의 상호작용 효과에 관한 가설
        - H0 : 요인 A와 요인 B의 상호작용 효과가 없음
        - H1 : 요인 A와 요인 B의 상호작용 효과가 존재

- 검정툥계량의 표본분포
    1. 요인 A의 처리효과
    - 요인 A에 관한 H0이 사실인 경우
    ![Alt text](/reference_statistics/image-85.png)
    2. 요인 B의 처리효과
    - 요인 B에 관한 H0이 사실인 경우
    ![Alt text](/reference_statistics/image-86.png)
    3. 요인 A와 요인 B의 상호작용효과
    - 요인 A와 요인 B의 상호작용에 관한 H0이 사실인 경우
    ![Alt text](/reference_statistics/image-87.png)

- 유의확률의 계산 : 귀무가설 H0가 사실일 때 검정통계량의 분포에서 f0(= 표본자료로부터 계산된 검정통계량의 값)보다 더 큰 값이 나올 확률
    - 유의수준(100a%)의 검정법 : 자료로부터 계산된 유의확률(p-value)이 주어진 유의수준 a보다 작은 경우에 귀무가설 H0를 기각\
    p-value <= a면 H0를 기각
    - 분산분석표
    ![Alt text](/reference_statistics/image-88.png)


## 18. 모분산 비교에 관한 가설검정(F-test of equality of variances)
#### 두 모집단의 모분산 차이
- 독립인 두 표본
![Alt text](/reference_statistics/image-89.png)

- 가설 유형 : 관심모수가 시그마1^2 / 시그마2^2 이고 검정하고자 하는 모수의 경계값은 1이 됨
![Alt text](/reference_statistics/image-90.png)
- 검정통계량 : 두 모집단이 모두 정규분포인 경우 다음의 검정통계량 X는 귀무가설 H0(시그마1^2 / 시그마2^2 = 1)이 사실일 때\
X = 1 * (s1^2 / s2^2) ~F[n1 - 1, n2 - 1]
